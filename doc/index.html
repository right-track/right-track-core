<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="About.html">About</a></li><li><a href="Agency.html">Agency</a></li><li><a href="DateTime.html">DateTime</a><ul class='methods'><li data-type='method'><a href="DateTime.html#.create">create</a></li><li data-type='method'><a href="DateTime.html#.createFromDate">createFromDate</a></li><li data-type='method'><a href="DateTime.html#.createFromJSDate">createFromJSDate</a></li><li data-type='method'><a href="DateTime.html#.createFromTime">createFromTime</a></li><li data-type='method'><a href="DateTime.html#.now">now</a></li><li data-type='method'><a href="DateTime.html#clone">clone</a></li><li data-type='method'><a href="DateTime.html#deltaDays">deltaDays</a></li><li data-type='method'><a href="DateTime.html#deltaMins">deltaMins</a></li><li data-type='method'><a href="DateTime.html#getDateDOW">getDateDOW</a></li><li data-type='method'><a href="DateTime.html#getDateInt">getDateInt</a></li><li data-type='method'><a href="DateTime.html#getDateReadable">getDateReadable</a></li><li data-type='method'><a href="DateTime.html#getTimeGTFS">getTimeGTFS</a></li><li data-type='method'><a href="DateTime.html#getTimeInt">getTimeInt</a></li><li data-type='method'><a href="DateTime.html#getTimeReadable">getTimeReadable</a></li><li data-type='method'><a href="DateTime.html#getTimeSeconds">getTimeSeconds</a></li><li data-type='method'><a href="DateTime.html#isDateSet">isDateSet</a></li><li data-type='method'><a href="DateTime.html#toHTTPString">toHTTPString</a></li><li data-type='method'><a href="DateTime.html#toMySQLString">toMySQLString</a></li><li data-type='method'><a href="DateTime.html#toString">toString</a></li><li data-type='method'><a href="DateTime.html#toTimestamp">toTimestamp</a></li></ul></li><li><a href="Favorite.html">Favorite</a><ul class='methods'><li data-type='method'><a href="Favorite.html#.createStation">createStation</a></li><li data-type='method'><a href="Favorite.html#.createTransit">createTransit</a></li><li data-type='method'><a href="Favorite.html#.createTrip">createTrip</a></li><li data-type='method'><a href="Favorite.html#.sortBySequence">sortBySequence</a></li><li data-type='method'><a href="Favorite.html#isStation">isStation</a></li><li data-type='method'><a href="Favorite.html#isTransit">isTransit</a></li><li data-type='method'><a href="Favorite.html#isTrip">isTrip</a></li></ul></li><li><a href="Holiday.html">Holiday</a></li><li><a href="Link.html">Link</a></li><li><a href="RightTrackAgency.html">RightTrackAgency</a><ul class='methods'><li data-type='method'><a href="RightTrackAgency.html#getConfig">getConfig</a></li><li data-type='method'><a href="RightTrackAgency.html#isFeedSupported">isFeedSupported</a></li><li data-type='method'><a href="RightTrackAgency.html#loadFeed">loadFeed</a></li><li data-type='method'><a href="RightTrackAgency.html#readConfig">readConfig</a></li><li data-type='method'><a href="RightTrackAgency.html#resetConfig">resetConfig</a></li></ul></li><li><a href="RightTrackDB.html">RightTrackDB</a><ul class='methods'><li data-type='method'><a href="RightTrackDB.html#get">get</a></li><li data-type='method'><a href="RightTrackDB.html#select">select</a></li></ul></li><li><a href="RightTrackTransitAgency.html">RightTrackTransitAgency</a><ul class='methods'><li data-type='method'><a href="RightTrackTransitAgency.html#getConfig">getConfig</a></li><li data-type='method'><a href="RightTrackTransitAgency.html#getDivision">getDivision</a></li><li data-type='method'><a href="RightTrackTransitAgency.html#loadFeed">loadFeed</a></li><li data-type='method'><a href="RightTrackTransitAgency.html#readConfig">readConfig</a></li><li data-type='method'><a href="RightTrackTransitAgency.html#resetConfig">resetConfig</a></li></ul></li><li><a href="Route.html">Route</a><ul class='methods'><li data-type='method'><a href="Route.html#.sortByName">sortByName</a></li></ul></li><li><a href="Service.html">Service</a></li><li><a href="ServiceException.html">ServiceException</a></li><li><a href="StationFeed.html">StationFeed</a></li><li><a href="StationFeedDeparture.html">StationFeedDeparture</a><ul class='methods'><li data-type='method'><a href="StationFeedDeparture.html#.sort">sort</a></li></ul></li><li><a href="StationFeedDepartureStatus.html">StationFeedDepartureStatus</a></li><li><a href="Stop.html">Stop</a><ul class='methods'><li data-type='method'><a href="Stop.html#.sortByDistance">sortByDistance</a></li><li data-type='method'><a href="Stop.html#.sortById">sortById</a></li><li data-type='method'><a href="Stop.html#.sortByName">sortByName</a></li><li data-type='method'><a href="Stop.html#.sortByTransferWeight">sortByTransferWeight</a></li><li data-type='method'><a href="Stop.html#setDistance">setDistance</a></li></ul></li><li><a href="StopTime.html">StopTime</a><ul class='methods'><li data-type='method'><a href="StopTime.html#.sortByStopSequence">sortByStopSequence</a></li><li data-type='method'><a href="StopTime.html#.sortByStopTransferWeight">sortByStopTransferWeight</a></li></ul></li><li><a href="TransitDivision.html">TransitDivision</a><ul class='methods'><li data-type='method'><a href="TransitDivision.html#getEventCount">getEventCount</a></li></ul></li><li><a href="TransitEvent.html">TransitEvent</a></li><li><a href="TransitFeed.html">TransitFeed</a><ul class='methods'><li data-type='method'><a href="TransitFeed.html#getEventCount">getEventCount</a></li></ul></li><li><a href="Trip.html">Trip</a><ul class='methods'><li data-type='method'><a href="Trip.html#.sortByDepartureTime">sortByDepartureTime</a></li><li data-type='method'><a href="Trip.html#getStopTime">getStopTime</a></li><li data-type='method'><a href="Trip.html#hasStopTime">hasStopTime</a></li></ul></li><li><a href="TripSearch.html">TripSearch</a><ul class='methods'><li data-type='method'><a href="TripSearch.html#search">search</a></li></ul></li><li><a href="TripSearchResult.html">TripSearchResult</a><ul class='methods'><li data-type='method'><a href="TripSearchResult.html#.sortByDeparture">sortByDeparture</a></li></ul></li><li><a href="TripSearchResultSegment.html">TripSearchResultSegment</a></li><li><a href="TripSearchResultTransfer.html">TripSearchResultTransfer</a></li></ul><h3>Modules</h3><ul><li><a href="module-_.html">/</a></li><li><a href="module-classes.html">classes</a></li><li><a href="module-classes_RightTrackAgency.html">classes/RightTrackAgency</a></li><li><a href="module-classes_RightTrackDB.html">classes/RightTrackDB</a></li><li><a href="module-classes_RightTrackTransitAgency.html">classes/RightTrackTransitAgency</a></li><li><a href="module-gtfs.html">gtfs</a></li><li><a href="module-gtfs_Agency.html">gtfs/Agency</a></li><li><a href="module-gtfs_Route.html">gtfs/Route</a></li><li><a href="module-gtfs_Service.html">gtfs/Service</a></li><li><a href="module-gtfs_ServiceException.html">gtfs/ServiceException</a></li><li><a href="module-gtfs_Stop.html">gtfs/Stop</a></li><li><a href="module-gtfs_StopTime.html">gtfs/StopTime</a></li><li><a href="module-gtfs_Trip.html">gtfs/Trip</a></li><li><a href="module-query.html">query</a><ul class='methods'><li data-type='method'><a href="module-query.html#.clearCache">clearCache</a></li></ul></li><li><a href="module-query_about.html">query/about</a><ul class='methods'><li data-type='method'><a href="module-query_about.html#~getAbout">getAbout</a></li></ul></li><li><a href="module-query_calendar.html">query/calendar</a><ul class='methods'><li data-type='method'><a href="module-query_calendar.html#~getService">getService</a></li><li data-type='method'><a href="module-query_calendar.html#~getServiceExceptions">getServiceExceptions</a></li><li data-type='method'><a href="module-query_calendar.html#~getServicesDefault">getServicesDefault</a></li><li data-type='method'><a href="module-query_calendar.html#~getServicesEffective">getServicesEffective</a></li></ul></li><li><a href="module-query_holiday.html">query/holiday</a><ul class='methods'><li data-type='method'><a href="module-query_holiday.html#~getHoliday">getHoliday</a></li><li data-type='method'><a href="module-query_holiday.html#~getHolidays">getHolidays</a></li><li data-type='method'><a href="module-query_holiday.html#~isHoliday">isHoliday</a></li></ul></li><li><a href="module-query_linegraph.html">query/linegraph</a><ul class='methods'><li data-type='method'><a href="module-query_linegraph.html#~buildGraph">buildGraph</a></li><li data-type='method'><a href="module-query_linegraph.html#~getNextStops">getNextStops</a></li><li data-type='method'><a href="module-query_linegraph.html#~getPaths">getPaths</a></li></ul></li><li><a href="module-query_links.html">query/links</a><ul class='methods'><li data-type='method'><a href="module-query_links.html#~getLinkCategories">getLinkCategories</a></li><li data-type='method'><a href="module-query_links.html#~getLinks">getLinks</a></li><li data-type='method'><a href="module-query_links.html#~getLinksByCategory">getLinksByCategory</a></li></ul></li><li><a href="module-query_routegraph.html">query/routegraph</a><ul class='methods'><li data-type='method'><a href="module-query_routegraph.html#~getNextStops">getNextStops</a></li></ul></li><li><a href="module-query_routes.html">query/routes</a><ul class='methods'><li data-type='method'><a href="module-query_routes.html#~getRoute">getRoute</a></li><li data-type='method'><a href="module-query_routes.html#~getRoutes">getRoutes</a></li></ul></li><li><a href="module-query_stops.html">query/stops</a><ul class='methods'><li data-type='method'><a href="module-query_stops.html#~getStop">getStop</a></li><li data-type='method'><a href="module-query_stops.html#~getStopByName">getStopByName</a></li><li data-type='method'><a href="module-query_stops.html#~getStopByStatusId">getStopByStatusId</a></li><li data-type='method'><a href="module-query_stops.html#~getStops">getStops</a></li><li data-type='method'><a href="module-query_stops.html#~getStopsByLocation">getStopsByLocation</a></li><li data-type='method'><a href="module-query_stops.html#~getStopsByRoute">getStopsByRoute</a></li></ul></li><li><a href="module-query_stoptimes.html">query/stoptimes</a><ul class='methods'><li data-type='method'><a href="module-query_stoptimes.html#~getStopTimeByTripStop">getStopTimeByTripStop</a></li><li data-type='method'><a href="module-query_stoptimes.html#~getStopTimesByTrip">getStopTimesByTrip</a></li></ul></li><li><a href="module-query_trips.html">query/trips</a><ul class='methods'><li data-type='method'><a href="module-query_trips.html#~getTrip">getTrip</a></li><li data-type='method'><a href="module-query_trips.html#~getTripByDeparture">getTripByDeparture</a></li><li data-type='method'><a href="module-query_trips.html#~getTripByShortName">getTripByShortName</a></li><li data-type='method'><a href="module-query_trips.html#~getTripsByDate">getTripsByDate</a></li></ul></li><li><a href="module-rt.html">rt</a></li><li><a href="module-rt_About.html">rt/About</a></li><li><a href="module-rt_Favorite.html">rt/Favorite</a></li><li><a href="module-rt_Holiday.html">rt/Holiday</a></li><li><a href="module-rt_Link.html">rt/Link</a></li><li><a href="module-search.html">search</a></li><li><a href="module-search_TripSearch.html">search/TripSearch</a></li><li><a href="module-search_TripSearchResult.html">search/TripSearchResult</a></li><li><a href="module-search_TripSearchResultSegment.html">search/TripSearchResultSegment</a></li><li><a href="module-search_TripSearchResultTransfer.html">search/TripSearchResultTransfer</a></li><li><a href="module-utils.html">utils</a></li><li><a href="module-utils_calc.html">utils/calc</a><ul class='methods'><li data-type='method'><a href="module-utils_calc.html#~distance">distance</a></li></ul></li><li><a href="module-utils_DateTime.html">utils/DateTime</a></li></ul>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1>Right Track Core Library</h1>
<p><strong>GitHub repo:</strong> <a href="https://github.com/right-track/right-track-core">right-track/right-track-core</a></p>
<hr>
<p>This Node module contains the core data classes and functionality of the
<a href="https://github.com/right-track/">Right Track Library</a>. It can query a
<em>RightTrackDB</em> (a SQLite database that combines GTFS data with additional data)
that is built using the <a href="https://github.com/right-track/right-track-db-build">right-track-db-build</a>
module and create data classes representing the queried data.</p>
<p>This module is a requirement for the <a href="https://github.com/right-track/right-track-server">right-track-server</a>
and the <a href="https://github.com/right-track/right-track-pwa">right-track-pwa</a> website.</p>
<p>Agency specific functionality (such as real-time feed information) is
added through the various implementation of the <em>RightTrackAgency</em> classes, such as
<a href="https://github.com/right-track/right-track-agency-mnr">Metro North</a> or <a href="https://github.com/right-track/right-track-agency-lirr">LIRR</a>.</p>
<h3>Features and Functionality</h3>
<p>This project is still very much a work in progress and is being actively
developed.  Functionality may be added and/or removed without notice.</p>
<p>Currently, the module supports the following features:</p>
<ul>
<li>GTFS Data Models:
<ul>
<li>Agency</li>
<li>Route</li>
<li>Service (from gtfs calendar.txt)</li>
<li>ServiceException (from gtfs calendar_dates.txt)</li>
<li>Stop</li>
<li>StopTime</li>
<li>Trip</li>
</ul>
</li>
<li>Right Track Data Models:
<ul>
<li>About (database metadata)</li>
<li>Favorite (Class for User favorites - station and trips)</li>
<li>Holiday (service information for holidays)</li>
<li>Link (links for additional transit resources)</li>
</ul>
</li>
<li>Right Track Database queries</li>
<li>Trip Search Classes and Query Functions
<ul>
<li>Trip Search</li>
<li>Trip Search Result</li>
<li>GTFS schedule search functions (including transfers)</li>
</ul>
</li>
<li>General purpose utility functions</li>
<li>Abstract Right Track Classes:
<ul>
<li>RightTrackDB (Class for managing the SQLite database)</li>
<li>RightTrackAgency (Class containing agency-specific information and the function for building Station Feeds)</li>
<li>RightTrackTransitAgency (Class containing transit agency-specific information and the function for building Transit Feeds)</li>
</ul>
</li>
</ul>
<h3>Documentation</h3>
<p>Full documentation can be found in the <strong>/doc/</strong> directory in this
repository or online at <a href="https://docs.righttrack.io/right-track-core">https://docs.righttrack.io/right-track-core</a></p>
<h3>Module Structure</h3>
<p>This module is essentially a bundled group of sub-modules representing each of
the supported data types.  To import the entire collection, <code>require</code> the
<code>right-track-core</code> module.  The returned Object will be a collection of all of
the sub-modules that follows a package-like structure mirroring the module paths.</p>
<p>For example, to get the GTFS <code>Agency</code> class from the collection:</p>
<pre class="prettyprint source lang-jacascript"><code>const core = require('right-track-core');
const Agency = core.gtfs.Agency;
</code></pre>
<p>Sub-modules can also be loaded individually by requiring the specific module:</p>
<pre class="prettyprint source lang-javascript"><code>const Agency = require('right-track-core/modules/gtfs/Agency');
</code></pre>
<p>Refer to the <strong>Documentation</strong> for the complete module structure.</p>
<h3>Usage</h3>
<h4>Create a GTFS data class</h4>
<pre class="prettyprint source lang-javascript"><code>const core = require('right-track-core');
const Agency = core.gtfs.Agency;
const Route = core.gtfs.Route;

// Create a new Agency for Metro North Railroad
let metroNorth = new Agency('Metro North Railroad', 'https://mta.info/mnr', 'America/New_York', 'mnr');
console.log(metroNorth);
// Agency {
//   name: 'Metro North Railroad',
//   url: 'https://mta.info/mnr',
//   timezone: 'America/New_York',
//   id: 'mnr' 
// }


// Create a new Route for the New Haven Line
let newHavenLine = new Route('nh', 'new haven', 'New Haven Line', Route.ROUTE_TYPE_RAIL, metroNorth, 'ff0000', '000000');
console.log(newHavenLine);
// Route {
//   id: 'nh',
//   shortName: 'new haven',
//   longName: 'New Haven Line',
//   type: 2,
//   agency:
//     Agency {
//       name: 'Metro North Railroad',
//       url: 'https://mta.info/mnr',
//       timezone: 'America/New_York',
//       id: 'mnr' 
//     },
//   color: 'ff0000',
//   textColor: '000000' 
// }
</code></pre>
<h4>Query a Right Track Database</h4>
<p>The <em>query</em> functions of this module query a specific type of SQLite database
(<a href="https://github.com/right-track/right-track-db-build">Right Track Database</a>) that
contains the GTFS data and additional Right Track data. In order to make a query,
there are two additional dependencies:</p>
<ul>
<li>
<p>A <strong>RightTrackDB</strong> Class Object. This acts as a SQLite wrapper that provides
the actual SQLite functionality.  The <a href="https://github.com/right-track/right-track-db-sqlite3">right-track-db-sqlite3</a>
module provides this functionality using the <a href="https://github.com/mapbox/node-sqlite3">node-sqlite3</a>
module and should work in any environment supported by node-sqlite3.</p>
</li>
<li>
<p>A <strong>Right Track Agency</strong> implementation.  This provides the agency-specific
configuration properties as well as the agency's Right Track Database (or the
location of the database).</p>
</li>
</ul>
<p>The following example queries the information for a <code>Stop</code> with id <code>110</code> from a
Right Track Database for <a href="https://github.com/right-track/right-track-agency-mnr">Metro North Railroad</a>.</p>
<pre class="prettyprint source lang-javascript"><code>const core = require('right-track-core');
const RightTrackDB = require('right-track-db-sqlite3');
const MNR = require('right-track-agency-mnr');

// Create the Right Track DB using the MNR Right Track Agency
let db = new RightTrackDB(MNR);

// Query the database for the stop with ID == '110'
core.query.stops.getStop(db, '110', function(err, stop) {
  console.log(stop);
});

// Returns Stop:
// Stop {
//   id: '110',
//   name: 'Larchmont',
//   lat: 40.933394,
//   lon: -73.759792,
//   url: 'http://as0.mta.info/mnr/stations/station_detail.cfm?key=208',
//   wheelchairBoarding: 1,
//   statusID: '110',
//   transferWeight: 1171 
// }
</code></pre>
<h4>Schedule Trip Search</h4>
<p>The <em>search</em> functions of this module can query the GTFS schedule to build a set
of Trip Search Results that connect the Origin and Destination Stops together with
either a direct Trip or one that includes one or more transfers.</p>
<p>The Search parameters can be customized with the following options:</p>
<table>
<thead>
<tr>
<th>Option Name</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allowTransfers</code></td>
<td><code>true</code></td>
<td>Enable to allow a Trip Search Result to include one or more transfers to a different Trip at a Transfer Stop.</td>
</tr>
<tr>
<td><code>allowChangeInDirection</code></td>
<td><code>true</code></td>
<td>Enable to allow transfers to a Trip running in the opposite direction.</td>
</tr>
<tr>
<td><code>preDepartureHours</code></td>
<td><code>3</code></td>
<td>The number of hours <strong>before</strong> the specified departure date/time to include in the results.</td>
</tr>
<tr>
<td><code>postDepartureHours</code></td>
<td><code>6</code></td>
<td>The number of hours <strong>after</strong> the specified departure date/time to include in the results.</td>
</tr>
<tr>
<td><code>maxLayoverMins</code></td>
<td><code>30</code></td>
<td>The maximum number of minutes to layover at a transfer Stop.</td>
</tr>
<tr>
<td><code>minLayoverMins</code></td>
<td><code>0</code></td>
<td>The minimum number of minutes to layover at a transfer Stop.</td>
</tr>
<tr>
<td><code>maxTransfers</code></td>
<td><code>2</code></td>
<td>The maximum number of transfers allowed per Trip Search Result.</td>
</tr>
</tbody>
</table>
<h5>Trip Search Example</h5>
<p>The following example searches the GTFS schedule for Long Island Rail Road between
the Patchogue and Atlantic Terminal Stops with a desired departure of 1:30 PM on Jan 16, 2018.</p>
<p>The default options were changed to allow search results up to 8 hours after the desired
departure.</p>
<pre class="prettyprint source lang-javascript"><code>const core = require('right-track-core');
const RightTrackDB = require('right-track-db-sqlite3');
const LIRR = require('right-track-agency-lirr');

const DateTime = core.utils.DateTime;
const TripSearch = core.search.TripSearch;

// Set up a Right Track DB for LIRR
let db = new RightTrackDB(LIRR);

// Get the Origin and Destination Stops by their IDs
core.query.stops.getStop(db, '124', function(err, origin) {
  core.query.stops.getStop(db, '12', function(err, destination) {

    // Set Search Paramters
    let dt = DateTime.create(&quot;1:30 PM&quot;, 20180116);
    let options = {
      postDepartureHours: 8
    };

    // Set up the Trip Search
    let search = new TripSearch(origin, destination, dt, options);

    // Perform the Trip Search
    search.search(db, function(err, results) {

      // Print the Results
      console.log(&quot;==== TRIP SEARCH RESULTS: ===&quot;);
      console.log(&quot;ORIGIN: &quot; + origin.name);
      console.log(&quot;DESTINATION: &quot; + destination.name);
      console.log(&quot;DEPARTURE: &quot; + dt.toString());
      console.log(&quot;RESULTS: &quot; + results.length);
      console.log(&quot;=============================&quot;);

      // Parse each Result
      for ( let i = 0; i &lt; results.length; i++ ) {
        let result = results[i];

        console.log(result.origin.stop.name + &quot; @ &quot; + result.origin.departure.getTimeReadable() + &quot; --> &quot; + result.destination.stop.name + &quot; @ &quot; + result.destination.arrival.getTimeReadable());

        // Parse segments when a transfer is required
        if ( result.length > 1 ) {
          let segments = result.segments;
          for ( let j = 0; j &lt; segments.length; j++ ) {
            let segment = segments[j];
            console.log(&quot;  &quot; + segment.enter.stop.name + &quot; @ &quot; + segment.enter.departure.getTimeReadable() + &quot; --> &quot; + segment.exit.stop.name + &quot; @ &quot; + segment.exit.arrival.getTimeReadable());
          }
        }

      }

    });

  });
});
</code></pre>
<p>The resulting output, which prints the Trip Search Results to the console:</p>
<pre class="prettyprint source"><code>==== TRIP SEARCH RESULTS: ===
ORIGIN: Patchogue
DESTINATION: Atlantic Terminal
DEPARTURE: 2018-01-16 @ 13:30:00
RESULTS: 9
=============================
Patchogue @ 11:25 AM --> Atlantic Terminal @ 1:33 PM
  Patchogue @ 11:25 AM --> Babylon @ 11:55 AM
  Babylon @ 12:00 PM --> Jamaica @ 12:48 PM
  Jamaica @ 1:13 PM --> Atlantic Terminal @ 1:33 PM
Patchogue @ 1:07 PM --> Atlantic Terminal @ 2:33 PM
  Patchogue @ 1:07 PM --> Jamaica @ 2:12 PM
  Jamaica @ 2:13 PM --> Atlantic Terminal @ 2:33 PM
Patchogue @ 1:25 PM --> Atlantic Terminal @ 3:33 PM
  Patchogue @ 1:25 PM --> Babylon @ 1:55 PM
  Babylon @ 2:00 PM --> Jamaica @ 2:48 PM
  Jamaica @ 3:13 PM --> Atlantic Terminal @ 3:33 PM
Patchogue @ 2:30 PM --> Atlantic Terminal @ 4:03 PM
  Patchogue @ 2:30 PM --> Jamaica @ 3:36 PM
  Jamaica @ 3:43 PM --> Atlantic Terminal @ 4:03 PM
Patchogue @ 3:32 PM --> Atlantic Terminal @ 5:10 PM
  Patchogue @ 3:32 PM --> Babylon @ 4:02 PM
  Babylon @ 4:06 PM --> Jamaica @ 4:44 PM
  Jamaica @ 4:52 PM --> Atlantic Terminal @ 5:10 PM
Patchogue @ 4:43 PM --> Atlantic Terminal @ 6:23 PM
  Patchogue @ 4:43 PM --> Jamaica @ 5:50 PM
  Jamaica @ 6:05 PM --> Atlantic Terminal @ 6:23 PM
Patchogue @ 5:26 PM --> Atlantic Terminal @ 7:10 PM
  Patchogue @ 5:26 PM --> Babylon @ 5:58 PM
  Babylon @ 6:03 PM --> Jamaica @ 6:40 PM
  Jamaica @ 6:52 PM --> Atlantic Terminal @ 7:10 PM
Patchogue @ 6:30 PM --> Atlantic Terminal @ 8:21 PM
  Patchogue @ 6:30 PM --> Babylon @ 7:03 PM
  Babylon @ 7:09 PM --> Jamaica @ 8:01 PM
  Jamaica @ 8:03 PM --> Atlantic Terminal @ 8:21 PM
Patchogue @ 7:39 PM --> Atlantic Terminal @ 9:53 PM
  Patchogue @ 7:39 PM --> Babylon @ 8:09 PM
  Babylon @ 8:13 PM --> Jamaica @ 9:04 PM
  Jamaica @ 9:33 PM --> Atlantic Terminal @ 9:53 PM
</code></pre>
<h3>Abstract Classes</h3>
<p>The <code>core</code> module now includes the abstract Right Track Classes that are used by
the implementing database, agency, and transit agency classes.</p>
<h4>Right Track Database</h4>
<p>This is the abstract <code>RightTrackDB</code> Class that is used by various <a href="https://github.com/right-track">Right Track projects</a>
to query the SQLite <a href="https://github.com/right-track/right-track-db-build">Right Track Database</a>.</p>
<p>An implementation of this Class, such as <a href="https://github.com/right-track/right-track-db-sqlite3">right-track-db-sqlite3</a>,
which uses the node <code>sqlite3</code> module, is what will actually be used in the projects.</p>
<p>An implementation of this Class must have the following functions:</p>
<ul>
<li>
<p><code>constructor({RightTrackAgency} agency)</code>:</p>
<ul>
<li>this is used to initialize the SQLite database</li>
<li><code>agency</code>: The <code>RightTrackAgency</code> this DB will be used to query.  The
agency must have the configuration properties set to the agency's id
as well as the database location.</li>
</ul>
</li>
<li>
<p><code>select({string} statement, {function} callback)</code>:</p>
<ul>
<li>this is used to SELECT multiple rows from the SQLite database using
the passed statement.  It will return the rows using the passed callback
function.</li>
<li><code>statement</code>: the full SQLite SELECT statement</li>
<li><code>callback</code>: the selectCallback function</li>
</ul>
</li>
<li>
<p><code>get({string} statement, {function} callback)</code>:</p>
<ul>
<li>this is used to SELECT a single row from the SQLite database using the
passed statement.  It will return the result using the passed callback
function.
<ul>
<li>If no rows are selected, it will return <code>undefined</code></li>
<li>If one row is selected, it will return the single row</li>
<li>If more than one row is selected, it will return the first row</li>
</ul>
</li>
<li><code>statement</code>: the full SQLite SELECT statement</li>
<li><code>callback</code>: the getCallback function</li>
</ul>
</li>
</ul>
<h4>Right Track Agency</h4>
<p>This module provides the abstract RightTrackAgency class which is extended by an implementing
Right Track Agency.</p>
<p>The abstract class provides the functionality for reading agency configuration files and
setting the configuration properties.</p>
<p>This module also includes the Station Feed Classes: StationFeed, StationFeedDeparture, and
StationFeedDepartureStatus, which are all required when an Agency implements the real-time
Station Feed functionality.</p>
<h5>Supported Agencies</h5>
<p>The following are Right Track Agencies that implement this abstract class:</p>
<ul>
<li><a href="https://github.com/right-track/right-track-agency-mnr">Metro North Railroad &amp; SLE (mnr)</a></li>
<li><a href="https://github.com/right-track/right-track-agency-lirr">Long Island Rail Road (lirr)</a></li>
</ul>
<h5>Configuration</h5>
<p>When a <code>RightTrackAgency</code> class is instantiated it will read the agency's default
configuration file (<code>agency.json</code> located in the root of the agency's module
directory).</p>
<h5>Get Agency Configuration</h5>
<p>To get the agency configuration use the <code>getConifg()</code> function.  The configuration
will have a structure similar to:</p>
<pre class="prettyprint source"><code>{
  &quot;name&quot;: &quot;Long Island Rail Road&quot;,
  &quot;id&quot;: &quot;lirr&quot;,
  &quot;maintainer&quot;: {
    &quot;name&quot;: &quot;David Waring&quot;,
    &quot;email&quot;: &quot;dev@davidwaring.net&quot;,
    &quot;website&quot;: &quot;https://www.davidwaring.net/&quot;
  },
  &quot;db&quot;: {
    &quot;location&quot;: &quot;./static/db/latest/database.db&quot;,
    &quot;archiveDir&quot;: &quot;./static/db/archive/&quot;
  },
  &quot;stationFeed&quot;: {
    &quot;stationURL&quot;: &quot;http://traintime.lirr.org/traintime.php?startsta={{ORIGIN_ID}}&endsta={{DESTINATION_ID}}&quot;,
    &quot;gtfsrt&quot;: {
      &quot;url&quot;: &quot;https://mnorth.prod.acquia-sites.com/wse/LIRR/gtfsrt/realtime/{{GTFS_RT_API_KEY}}/json&quot;,
      &quot;apiKey&quot;: &quot;&quot;
    }
  },
  &quot;static&quot;: {
    &quot;img&quot;: {
      &quot;icon&quot;: &quot;./static/img/icon.png&quot;
    }
  },
  &quot;build&quot;: {
    &quot;updateURL&quot;: &quot;http://web.mta.info/developers/data/lirr/google_transit.zip&quot;
  },
  &quot;colors&quot;: {
    &quot;primary&quot;: &quot;#0f47a1&quot;,
    &quot;primaryText&quot;: &quot;#dddddd&quot;,
    &quot;secondary&quot;: &quot;#ffd54f&quot;,
    &quot;secondaryText&quot;: &quot;#263238&quot;
  }
}
</code></pre>
<h5>Additional Configuration</h5>
<p>To provide additional configuration variables, or to override the default ones,
create a new configuration file with the variables to add:</p>
<pre class="prettyprint source lang-json"><code>{
    &quot;db&quot;: {
        &quot;location&quot;: &quot;/new/path/to/database.db&quot;
    },
    &quot;stationFeed&quot;: {
        &quot;gtfsrt&quot;: {
            &quot;apiKey&quot;: &quot;your-mta-api-key&quot;
        }
    }
}
</code></pre>
<p>Then, use the <code>readConfig(configFile)</code> to parse the configuration file and
merge its properties with those already loaded.</p>
<p>The <code>configFile</code> path can be an absolute or relative path, with relative
paths loaded relative to the root of the agency's module directory.</p>
<p>Any relative paths in the configuration file will be loaded relative to the
directory the new configuration file is located in.</p>
<h5>Station Feed</h5>
<p>A <strong>Station Feed</strong> provides a list of scheduled departures from a single Stop
combined with agency-specific real-time information, such as departure
status and/or track numbers.</p>
<p>To load an agency-specific <code>StationFeed</code>, use the <code>loadFeed(db, origin, callback)</code>
function where:</p>
<ul>
<li><code>db</code> is the agency's RightTrackDB</li>
<li><code>origin</code> is the origin Stop</li>
<li><code>callback</code> is a callback function: <code>function(err, feed)</code>
<ul>
<li>accepting an <code>Error</code> and <code>StationFeed</code> as arguments.</li>
</ul>
</li>
</ul>
<p>See the Documentation for more information on the structure of a <code>StationFeed</code>.</p>
<h5>Example</h5>
<p>The following example uses the <a href="https://github.com/right-track/right-track-agency-mnr">right-track-agency-mnr</a>
module, which is the Metro North Railroad implementation of a <code>RightTrackAgency</code>.</p>
<pre class="prettyprint source lang-javascript"><code>const MNR = require('right-track-agency-mnr');
const RightTrackDB = require('right-track-db-sqlite3');
const core = require('right-track-core');

// Load an additional configuration file
// This path is relative to the agency's module directory
MNR.readConfig('./path/to/config.json');

// Create a RightTrackDB for this Agency
let db = new RightTrackDB(MNR);

// Query the Database for Stop with id = '1'
core.query.stops.getStop(db, '1', function(err, stop) {
  
  // Load the agency's StationFeed for this Stop
  MNR.loadFeed(db, stop, function(err, feed) {
    
    // Do something with the station feed
    console.log(feed);
    
  });
  
});
</code></pre>
<h4>Right Track Transit Agency</h4>
<p>This module provides the abstract <code>RightTrackTransitAgency</code> class which is extended by
an implementing Right Track Transit Agency.</p>
<p>This module also includes the <strong>Transit Feed</strong> Classes: <code>TransitFeed</code>, <code>TransitDivision</code>,
and <code>TransitEvent</code>, which are all required when a Transit Agency implements the real-time
Transit Feed functionality.</p>
<h5>Supported Agencies</h5>
<p>The following are Right Track Transit Agencies that implement this abstract class:</p>
<ul>
<li><a href="https://github.com/right-track/right-track-transit-mta">Metropolitan Transportation Authority (mta)</a></li>
<li><a href="https://github.com/right-track/right-track-transit-nysta">NYS Thruway Authority (nysta)</a></li>
</ul>
<h5>Transit Feed</h5>
<p>A <strong>Transit Feed</strong> provides a list of real-time transit events.  A Transit Feed
is broken down into a hierarchical system where a single <strong>Transit Feed</strong> includes
one or more <strong>Divisions</strong>, which in turn includes either one or more child Divisions
or a list of <strong>Events</strong> (which contain the real-time transit status information).</p>
<p>To load an agency-specific <code>TransitFeed</code>, use the <code>loadFeed(callback)</code>
function where:</p>
<ul>
<li><code>callback</code> is a callback function: <code>function(err, feed)</code>
<ul>
<li>accepting an <code>Error</code> and <code>TransitFeed</code> as arguments.</li>
</ul>
</li>
</ul>
<p>See the Documentation for more information on the structure of a <code>TransitFeed</code>.</p>
<h5>Example</h5>
<p>The following example uses the <a href="https://github.com/right-track/right-track-transit-mta">right-track-transit-mta</a>
module to build a <strong>Transit Feed</strong> for the Metropolitan Transportation Authority.</p>
<pre class="prettyprint source lang-javascript"><code>const mta = require('right-track-transit-mta');

mta.loadFeed(function(err, feed) {
  if ( !err ) {
    console.log(JSON.stringify(feed, null, 2));
  }
});
</code></pre></article>
    </section>






</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Wed Dec 08 2021 11:17:17 GMT-0500 (Eastern Standard Time) using the <a href="https://github.com/dwaring87/docdash">@dwaring87/docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>